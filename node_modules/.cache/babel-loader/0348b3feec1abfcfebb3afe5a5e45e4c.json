{"ast":null,"code":"import { toast } from 'react-toastify';\nconst BASE_URL = 'https://frontend-test-assignment-api.abz.agency/api/v1';\n\nconst axios = require('axios');\n\nlet token;\n\nasync function getNewToken() {\n  await axios.get(`${BASE_URL}/token`).then(function (response) {\n    token = response.data.token;\n    console.log('token:', token);\n    return token;\n  }).catch(function (error) {\n    console.log(error);\n    return error;\n  });\n}\n\nasync function getUsers(page) {\n  try {\n    const response = await axios.get(`${BASE_URL}/users?page=${page}&count=6`);\n    const pages = response.data.total_pages;\n    const users = response.data.users.map(_ref => {\n      let {\n        photo,\n        email,\n        id,\n        name,\n        phone,\n        position,\n        position_id,\n        registration_timestamp\n      } = _ref;\n      return {\n        email: email,\n        id: id,\n        name: name,\n        phone: phone,\n        position: position,\n        photo: photo,\n        position_id: position_id,\n        registration_timestamp: registration_timestamp\n      };\n    });\n    console.log(response.data.links.next_url);\n    toast.success('ok', {\n      position: \"top-right\",\n      autoClose: 3000,\n      hideProgressBar: false,\n      closeOnClick: true,\n      pauseOnHover: true,\n      draggable: true,\n      progress: undefined\n    });\n    return {\n      users: users,\n      pages: pages\n    };\n  } catch (error) {\n    return error;\n  }\n}\n\nasync function getPositions() {\n  try {\n    const response = await axios.get(`${BASE_URL}/positions`);\n    const positions = response.data.positions;\n    return positions;\n  } catch (error) {\n    return error;\n  }\n}\n\nasync function addNewUser(userFormData) {\n  await getNewToken();\n  await axios({\n    method: \"post\",\n    url: `${BASE_URL}/users`,\n    data: userFormData,\n    headers: {\n      \"Token\": token\n    }\n  }).then(function (response) {\n    console.log(response.data);\n    console.log('success');\n    toast.success(response.data.message, {\n      position: \"top-right\",\n      autoClose: 3000,\n      hideProgressBar: false,\n      closeOnClick: true,\n      pauseOnHover: true,\n      draggable: true,\n      progress: undefined\n    });\n  }).catch(function (response) {\n    console.log('error response!');\n    console.log(response.data);\n    toast.error(response.data.message, {\n      position: \"top-right\",\n      autoClose: 3000,\n      hideProgressBar: false,\n      closeOnClick: true,\n      pauseOnHover: true,\n      draggable: true,\n      progress: undefined\n    });\n  });\n}\n\nexport { getNewToken, getUsers, getPositions, addNewUser // getPages\n};","map":{"version":3,"names":["toast","BASE_URL","axios","require","token","getNewToken","get","then","response","data","console","log","catch","error","getUsers","page","pages","total_pages","users","map","photo","email","id","name","phone","position","position_id","registration_timestamp","links","next_url","success","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","progress","undefined","getPositions","positions","addNewUser","userFormData","method","url","headers","message"],"sources":["/home/pavel/Desktop/Work/abz-test-app/src/services/users-api.js"],"sourcesContent":["import { toast } from 'react-toastify';\n\nconst BASE_URL = 'https://frontend-test-assignment-api.abz.agency/api/v1';\nconst axios = require('axios');\nlet token;\n\nasync function getNewToken() {\n    await axios.get(`${BASE_URL}/token`)\n    .then(function(response) { \n        token = response.data.token;\n        console.log('token:', token)\n        return token; \n    }) \n    .catch(function(error) { \n        console.log(error)\n        return error;\n    });\n        \n}\n\nasync function getUsers(page) {\n    try {\n        const response = await axios.get(\n            `${BASE_URL}/users?page=${page}&count=6`\n        )\n        const pages = response.data.total_pages;\n        const users = response.data.users.map(({photo,email,id,name,phone,position,position_id,registration_timestamp}) => {\n            return {\n                email: email,\n                id: id,\n                name: name,\n                phone: phone,\n                position: position,\n                photo: photo,\n                position_id: position_id,\n                registration_timestamp: registration_timestamp,\n            };\n          });\n          console.log(response.data.links.next_url);\n          toast.success('ok', {\n            position: \"top-right\",\n            autoClose: 3000,\n            hideProgressBar: false,\n            closeOnClick: true,\n            pauseOnHover: true,\n            draggable: true,\n            progress: undefined,\n        });\n        return {users: users, pages:pages}; \n\n    } catch(error){\n        return error;\n    }\n}\n\n\nasync function getPositions() {\n    try{\n        const response = await axios.get(\n            `${BASE_URL}/positions`\n        )\n        const positions = response.data.positions;\n\n        return positions; \n    } catch(error){\n        return error;\n    }\n}\n\nasync function addNewUser(userFormData) {\n    await getNewToken();\n    await axios({\n        method: \"post\",\n        url: `${BASE_URL}/users`,\n        data: userFormData,\n        headers: { \"Token\": token },\n      })\n        .then(function (response) {\n            console.log(response.data);\n            console.log('success')\n            toast.success(response.data.message, {\n                position: \"top-right\",\n                autoClose: 3000,\n                hideProgressBar: false,\n                closeOnClick: true,\n                pauseOnHover: true,\n                draggable: true,\n                progress: undefined,\n            });\n            \n        })\n        .catch(function (response) {\n            console.log('error response!')\n            console.log(response.data);\n            toast.error(response.data.message, {\n                position: \"top-right\",\n                autoClose: 3000,\n                hideProgressBar: false,\n                closeOnClick: true,\n                pauseOnHover: true,\n                draggable: true,\n                progress: undefined,\n            });\n        });\n}\n\n\nexport {\n    getNewToken,\n    getUsers,\n    getPositions,\n    addNewUser,\n    // getPages\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}